# go-notify-customer

Сервис представляет собой единую точку отправки уведомлений для всех клиентов (приложений) имеющих доступ к интерфейсу отправки.

### Бизнес требования:

* Отправка смс и email уведомлений конечным пользователям (клиенты, сотрудники организации). Инициатором отправки уведомления является приложение имеющее доступ к интерфейсу отправки.

* Необходимо заложить возможность расширения каналов уведомления в дальнейшем (WhatsApp, Slack, и тд.)

* Добавление и редактирование шаблона сообщения уведомления с указанием:
  * Название шаблона
  *	Тип уведомления (смс, email)
  *	Текст уведомления с возможностью использования подстановок

* Возможность регистрации события, по которому будет отправляться уведомление с установленным шаблоном 
  * Название события
  *	Название шаблона

* Возможность указания приоритета отправки уведомлений

* Возможность установки ограничений (rate limit) на отправку уведомлений

* Логирование отправки уведомлений, сохранение статистики отправки

### Технические требования:

CRUD событий и шаблонов должны быть реализованы через REST-like интерфейс.

Операции, которые могут занять много времени (отправка данных через внешние сервисы) необходимо выполнять асинхронно.

Работа с внешними сервисами должна осуществляться через универсальный интерфейс, должна сохраняться возможность замены сервиса-исполнителя с минимальными изменениями в системе.

Необходимо поддерживать трассировку Jaegger

Обмен данными с Valut по протоколу GRPC

### Архитектура приложения:

[Общая схема](https://viewer.diagrams.net/?highlight=0000ff&nav=1&title=notification_final.drawio#R7V1bd6M4Ev41OWf2ITlI3B9zcXb6bPdMtpO57Ru2Scw0Nm6Mk3h%2B%2FUqAsFAJjGNA2O3uGbeRAePSV6p76UK%2Fnb%2F%2FO%2FaWsy%2FR1A8vsDZ9v9DvLjDGumGSf%2BjIJhu5NNx85CUOptkY2g48Bv%2F4%2BaCWj66Dqb8qnZhEUZgEy%2FLgJFos%2FElSGvPiOHorn%2FYcheVvXXovPhh4nHghHP0jmCazbNTB9nb8Zz94mbFvRpabfTL32Mn5L1nNvGn0xg3powv9No6iJHs3f7%2F1Q0o9RpfsuvuKT4sHi%2F1F0uSC9%2F88hD%2F%2F7j29OqOfL18j9%2Ff%2Fff%2FjMr%2FLqxeu8x8891crShNsheS2N%2BOYvHtJ362fn%2F04%2Fy3JhhEojtaLqU%2B%2FQyMnvc2CxH9cehP66RvBBBmbJfOQHCHydpXE0Tf%2FNgqjOL1a19I%2F5JPnIAy58ZFF%2F5Lx%2FPn8OPHfK384KshJgOhHcz%2BJN%2BSU%2FIJLy8inIAchsl09G3jbTqnB5mnGTaebj3k5il6Km28JTd7ktN6D7hjQ0Z8S3OWHUZzMopdo4YWj7ehNmdLbcz5H0TKn799%2BkmxyJvLWSVSmPqFXvPmTXn9lssO%2F8tulB3fvpaNNfpQ9K33A%2BhkgvydaxxO%2F5nfndE%2B8%2BMVPas4z5TMa%2B6GXBK%2Fl52h9cnTAFL9ESfAcTMh3R4sVmLoM1Wx5wALkZ96Snjd%2Ff6FL5NVzGL1NZl6cXM3XZBm7nEaT9Tylo5R52sC%2FiXAZ%2F1h3AP4dB8Lf6gr%2Bhgr4twhjsyGMbZUwNmthTH%2BmH78GE8lS%2F%2FDr49MFXQ%2FvF6UrKpd%2BtHvpbwXI2CkDWTchkJFsIe8MydYPupDbDTnAVckBNuCAhziI4iChj%2FB97ZNR5ZguIDwcTDs%2FKKbdhphGSrUTF4D6q5cQIGthMCdohRo6uSexlvzdcC5jvxVw6wK4DUuieUiw7XSFbWZXHq3qgZrqHshSiVKEfhg6OwfSOb30Oo69DXfCMgoWyYq78wMd4HUhUW5YhiPMWnbP7RwWD3fAtCoxXFVMK%2BejUcE%2Bei2d%2FXAcvbVK4mrPjP8eJH8yIU3e%2F7WV0eRoK5XpwYY7ePDjgBDDj3mxnQl4rErCG1ZfIv5jTK2LBo5p98HU9eZ4%2B2DbQqGEg63iV4GE9EjEVTVyVSwbxqFS94PSwNJUAGeni2EarJZeMpnVOo5VWVqmq9rSQhYg4FPsTb4Fi5fU%2F2J5c0qI7JWMPCaEsKskmEAnZO%2FkRK4xOHLax66dOA2XGb1icnrSThwA29HcC0L1oLSQwOM2Ug5KdzCqXItIZSTcjVSlzhL2mBxSH%2BcHLp676NuylFKPYHzstjxuGnbESgM2%2BNiN6%2BZ0VhoWwDDA%2B8hCYdoyjl6DKdVXNaJi%2B%2FEzXQaGJ9dc5coWPvYgLm5q0%2Bm6UrRCI2voaAUybABorQ%2FUdunjuLJL7q7iwwonB1Av7u9dl0CwXew3jd8eHEX4mD8DaYJx6Tg9%2BDMwDBjfBTFNK6TJEoupes4S5QDGmnvFVgh1zFUfMe6UuQbIW43jyIp4S1fCWzBu%2FcULwsksmC%2FV85Up8hXSB8BXen2wugO%2BymM9TGbl4R72UUWwp0rS7Qrs9OKo0FnW%2BM5cPbU5pzAT%2B6s3HgfJl%2F%2Bq5w5gfTiaan1OV2IrV8YwByF49Kbmt9rUEB2a309vQRhE6oEuGi5Ys4cgBnqPz56gGGicsn1oOs9hUw2N%2FXbEQM9O6wEICIUG%2FwDh39TeN5SmPenQACf38ZYBeX1F9N6qRYRuiBmtpq0a6UOxvoeB9KbWt6401qNDc%2Fh6TfCDtYg6cz890N%2B6Hi%2F8JH2k72t%2FRd9V5XgPRxYABtEt1QxiwCBwVSWU5i%2BmWwdKucrvLZiH3oJy0HO0SBh7UbJNZkE4%2FextojX9KavEm3xjRzezKA7%2BIed7W%2Bp7cZLzlq6VznikV%2Bb3jP0VOeeB0R0JQ1%2B899KJn71Vwp4mCkNvuQrG6fPRC%2BeEF4LFTZQk0fziwELdNiCiiclqBoQIZs5YHiIFbiq9YfP3r%2F4k8RYvob%2F9QoTYQzK9nhX28l%2BoSTCpC9%2FnhYT7Fl7i31CGWwFotuAoM6AngNzHf%2FVTUGqX5P8RPSD%2Ffh2ldXrVkR8yRwmYzUWUgZiruM6HvDB4WZDD0H%2Bml9FJJjwSXufD82A6TSXIiuAmWLx8Tk%2B7M7YjX3PK0aGIXE6LXcnhjFzokzvc5KxFns28If8R4t5SGWKSZ70lx2h7TP6jp8fJbbQgj%2B8FKbR8gvI3uhJSKZZ4iTcueLAN0b%2BXRrQpI2QXdEUktbe6YRleEn%2B%2BJHLMZ5B5yo%2FPqBkEaizlqIFOGKHclyFHEJUUPZdh8M0vslMX4xX954wnhXiSybN%2B8XQsNQS9GCFGU2%2BT0piDAZ1NTLOorftnLS12tK7gJmuczfbncT%2FuKFtUMGU11W6vJghM9L%2BlKn%2BaWvDqrcOEt0IEehNDIgwWhFqsxRGl09RbzQr%2BYWvkZ2%2Fshw%2FRKkjnTb8b5yo%2FWESTaMmttBN%2FkdbT1PUt8d5W%2BlX2pLBbj2ZigwYzyKnTgNxMWNG7nW3DFus6JM5H04CzbZtdzTZ0Y73Ey0mVYKy0u3bLyGLmKqWkjDPLi28Lc4BtS8gpsNgANwdWAwOrvTno2ytWU0H5QVHVokAym6brZ3xyaE4KSDrBjmOVAWIb6Ergv%2Bzh8is7MKxPshDDPNRhXzVhYpaQZbqNpmvffCTJN9muMP8d5COZ0Cl4Frx7LvquLfC0Bhf9XgWvWV%2Bpcqwsjpsu3q2sBfszMFLCwNDvdRoRFKhMma4L%2BKrfEIrZdz%2BKQccY2Zq2myGVJlqxx6wTcYUt7yXeKoniKpOhN%2FC7ojZgI3xlwxQsmTFh2qJK2R4tzYEwwK5MQ3U9MsymzVVUiSksIMvBfYgp6Pm58yfRlEZiKNMBWKnlPlB3YygXPdCZwgWzlt4mjLwpXNfO0XoN2gv36Z92sGLauggVGIRAhgQqqLPufiZsTPEUJOE5JNVFSMqsSKCqDoxL0dCZB5D5K0or72oSB0tpVOMMic4hIYl69wsJCzp9bqLp5oyF%2FrEgiVj3jAWYZ3U78xaLdAeTZLM8Cw0FqChUS3WwgG4lFhT%2F7bdPd2dQKACFqRwUMFuKgeJsgKgyQHTjwwaI2RlQoMvtbIB0tWxYFX15hmKAWDC%2F6myAKIWEegNE5g18zvO%2FlsXmJGdk9I0M9eaIpPTRpD1%2FU7KKWdgTZqmckdI3UgZgokAvpwCPs1KqSilFaIBKKXSEnk3arheRijYSQ9FNbUn6GyduHvx4la4kZ4CoAYhyTdWWlKFyAPnCtgmmv9SbnyHSP0SUq6w2dJX%2B9MuaCG5Cm3%2FRReRszygDh3ot1T6nDILugk1aoyttNm2razWG%2BVZj2kXDVmMHtuFTOtVqN3GxoXdyG%2F98i%2BJv3SVJd2h%2FSTrlazpcCXvNYLPPrchAg70mK6HS4mi7fi%2Bp80rY5lSr3STIhv60U1gJ4S4M6lfC%2BhLM091anGW87uQEB6vkBEfiFSp3halhhLbMnXpYO%2BJOl7oLiw77RbUj69jVP8zbhCtuCFdXaYETe0ye8IR6rkNfb%2B4uCFmcdOTGTN9r6avBRsirm46Q57PS8toxWeitF%2FquqkHg0NBvqEd%2FvZ1%2FBGBvWs3nHtob4TA6w9SirYNN%2B7721%2BrhiTQs4NNUj8%2F6yr0jwGfTujpXae9mB6a2dLQY3zXZVLonwBe1TEXtu3rAy5poHzUHuE21Z1dp834H2pEnQfgD6JlfKpTiIsya3BZZEoxreuoFhCSVgicxV012f6lKt%2B%2BHS1xoY9as74PRvOFKbytf6d36djcdYbZBo7NL7UpDdsnXcmUa1g5%2Fi7R1QZsc0tSqJWpsV%2BseIYzpOFg3sWsgJPRPch39yuX%2B9NsfjZFHVODuU7VMT1U0lL7epK%2BZYnedvmbKnMXGyft7cifuQszpeZnON0pfb7kbmkxTFG5SXD4qH95x2iSvZY7y1%2Fzk7NAuq578w5CRW3Zy8XOK%2B2vcE2rsNIO7M%2BJUW%2F7xrvMfMryVy1G%2FcilxGgzAEew2dTY4Sj1rLnQ2fM0abuzun6UK1epdDa4SV8MA2ou6TV0UjlIXmgtdFMfi5x0AuKHF9HteuJQKOpsTgPecmGVCEhcfCS4gxKkDgshNJfNWsGcjZlkI87JaOO2QSRQis8%2FOxJ9MZNrv2DENU%2Bto2gdgYygO2e63pnVtQiCtsZWtKc3uKh6UY9fHJIqznO3qvTp6F%2BO6KMYNJMlc7RXy%2BdQ1a5w42YQBoVis7yYX2AVh7E2%2BvaQU%2FzXrNJyPrzK2QGZLNDZB1FCDNJY1VPxAo65o%2FLef7mqwDAkdZlFIaLMqPfjEeNos5eJ3vF6xc9LtEQhJslUWbw%2FZPfzJbEFW4ZcNU0%2F5bVInBl9pvbVlETNJs9ADH4BI5VFJstyUbVBeNl1zMuu%2BmQl7z12S3V%2Fn5CPmPsUVN4RC8BDzOg24pMQKafNqBvMs9kKrA0t4t76vI%2FbBZYbPa3ICspbv2w9ZvKaI4GwHzHzWaVJf9iHBzVi8gIxl31wengavxZCZ3YzDg5k%2BSnkzouwLtxDBWTZ%2F8S38HUG4Sfa1%2B9IF1dElv8ukUCK2J%2Boji%2F6VXWuWQV2ipIxq4s%2FEu9c93u2Vr5Q7ljx%2BqZoGMWH9jOGIJKULy95LYln%2BpMi8KVbJmlIRQjmsX%2BM7NydvrlkgnB%2Fzqlz650LShR16Nkf23TUt%2BSCrnjeaBkn%2BlGLBCG07e5uWjQhFI9iUDMrG7PJgdhIqj0lPlNxRE746LVpJS2y5wpQ25ArShTCOK1FXsbTYtW4jxwrJQg5z4bKXLIetewo9SBDpJ7Mdi0TgS6qQe92OBWnQo3Tae%2BIgzRS4w5Fsj9DzJNTVfPyxK9O5J4vA1oUSeh1J8pZ73b4LadBz9EDrXn%2FwbYI7mW5DbzjdtR0T8i%2BU7QYs5KjZDlwbnQZs2cNewEiDuTyZoZOqj%2Bm2NJnlJG0lfq6zPbzONmd9iN%2BaTg4ysHa4qEPH7GOxn%2FkZJEMAiaybQ88ggT1gKNXWcwoSefLwGRjdA0PWw6FfYDBvK9%2BRLs%2B%2FOiNDITKkDRx6hgZ0g0NrId0jvJSjsw39Xct8q3ecM%2FKeuwRVpObw6TVY5hMtnJ3uRSnjB4NQpDQ7pwU36lW1D5Ebyf3PMAspfdb2vcTpeJtJWE4e580PBV%2B68LsoE%2B4zH8zZLtLkwLkpKFCV%2F2VXU%2F6aezAhiUxKbYq%2FIoFAW8bRazCVGNQn4%2BHAoNpHZqnrtsx0M7pbtTBYtT5VhjvP1vrBzhm7BedMtbGOhfCwLXFkDsVYR9DVTBaBib9a%2FfSvsw7VhQ6FsByt3dvmww5zN095FvKvRpxkd6ujxmWJ2TB1OhPWolbQMC9byCgr9AH%2BK%2Bpj5VqzrO1R%2FltS%2Bp4j4%2BfIeLbQ8Hmr58j4OTK%2BQ01yWKP%2FoiyY7UY3nMg4qm9L1nVmZ3EwkMxOlE%2FQ7sxOpDSJvagaO53S1T1or7YpHEKwnEth3dKH9oIu%2BsxdcE3mrljLOXmbuY8mwx8dZ6aX7ruzNDGKhU5rjuVeZUhlcGtwkY3Eiy462ZEa7ehHObCUfjVIstVm7yNJuG5wiTouFpQcR4dKTs%2Bp%2BximmR27cMRN%2BwkjrLSxQ%2FGg0kSErTt8SNUnAMKuRE%2FvG8KSRkrHDmG7MYSVdvApHnQHhIcGW6y56mEL05BG76nTPXWWDKSwFpIOD0BoQWkPnJ5O2W3qcA5ZxLlfC1%2FnPRfBdTj3qNTtizhvKQbR09Q3ejxO21MMtSLbEE0MLIGt2Wt%2BCLuz2DCmpjsLDCJIp7cI%2Bhe5B9R1fP3w6XRnWNeEwKoseoVl61KHEyypgyW%2F9xpmsRSLRl7q%2F0tdy%2BiTmTOExD52Q5g0DCYNdrPfO2ur75SqEwaNK7b9wswTxGfNaLhX0MDUhYacngtrERF3somF5dD99AHRYCTzp%2FQ8vmeJzn2ZzkktFtauLA0X9BKelUblZyoownL6SqpYNZXTB6hMITl%2BlsC2AYSfepboeyusXrZkQXpjb5Ku1pukQ2%2FSNY2cYy2iAuzTA0UHRWcYrKhfPYPsG6EJmLeWNmtpQ8uDlbkuRHrP5qfe9%2F5UPSG9sdPJONTZ%2F6GwkW6ZAhasvIN0t%2BEfHfq4fn56ouxE1ETCQnX%2BraFudgT5ytLU81V9sPgH2%2FcNMT9bA8mjNsivQ3dcziCx%2F31Nc1yPScDojnJGYHlOJyZgmPHfQMAo3dS1eFBpVKNJNG6wy76lC7a0jdSjHZ8m2vXGaD%2B0dfHH1CnHEGK5ttuHOmVIGgztDHYNlqEcJBJxAAx1mpa40bRpch7WUc9QLu6Foeq7aHe5867dfOfdoWFEtYoBk1b2azd7PCuiI%2FFN9r0i9r05dT9ob2edgwuZy2Ll241WnPJNut5uyujbFdBgkx6FebjM8dVA9LXimpNAwgF77zSDxN5S1LXEbbh78fIZ9X3bu5SiQxOinS0rmigZ3K4wJH5TP5oYY1O5UJ8vw%2BOU54KDzDWVy3NT4qCpaFLLSk1pL7cVOcdX7HA0NE1cSSX6kbR9o9YdPXENcENvc8pdWXRd9ACzxWLXhHQXSzdrfCQ%2F3nxYkpBvz%2FMBq2SeYm%2Bxol09fogZEewBXSICep4RmO3AErCKlFg%2Bre66nCrLt93SQBo339qKT5jepiHdfv3t7mKfbKQLSYq3w6X0ZV9gVWeBnSy4TBvkhCrPZbKgIgdm4MhKiszG2R1ZRZcyz5gpKSlKvLTLCUvLrVSie6qJAXswqd92DFnHj9DG%2BQ6W2mJj9qACQoMVWUYv%2BJaGAyrcBJC1TPWQVbz9537NIdqEutU4E0I71Bdz4BTJDG0J1AcHb1N90ME6qrYRnfcLshorIJbammZLpoAMbydIXAR%2BWWVuseuKQszDomZAqCPaCZKYvmVnHdZcSOOWdoJsSmKZ9nHiG3TBeSiS8JXtDWWfno1oN1ZLbLXZE7ZcLRmQjQhW5yE0%2B7GPH6GNkypttTnxtmwbxWHbiBCyrqwhdM%2BQrc9l7NlG3FUY0irUGxceWmoLD21JG6sB2ohQX9ZQdysyOYyjKOETDMiPmn2JprRB9uj%2F)

[Sequence диаграмма - Процесс отправки уведомления, успешная отправка](https://sequencediagram.org/index.html?presentationMode=readOnly#initialData=C4S2BsFMAJHwQQBEEHwggxEEKwghBEHdRghEEPwg8gDCCBMIIFwggHCDSDCIMaoCwgigPCCDcIKoLwg5g8iDQC016eVIAkQNoW64CJUoQBQMgA4BDAE6gAxiCUA7YNAByAe1AAzEGsWgDW6MsgBHAK6QAzsAUr1mxTv1GQp80trAGVIZQA3M0h3VTMvHwAFZRADZOAAT2hHSCcYz21dACULGHAQAFswMLy4gugAUXDIH2cwyLVomUU1UHCS3xMzCxTrW2zXGUNBwJGbeydXHgA+Kf8hoOhQiKiALgSAeWCAFQAdLQB6RXkQc-CARnOtPwDhq2dJ5-XZrfbIZaSUmlMtknHtkqkwCAAF4wJ7TV5aGQAiEZLJOJzLYrAUoVKrKHYAQQcwAAFhCYXNxm4sTjKtjlMtGs1dK1th0dgBxSC6NQk7xaSDgd5MlptKKY-plOlhHYAbWgAF1oLz+YL3jToFK8ctVi8NgAREDOJTAXkyglqDryNy6r5WaCG40WM0MpYANUUDnAwE53OgABMLIpoPKlfIws57QBVKMASX1Mg9XuAOs+M3tjpNLrliug4eUkesoeVVmA3WA71t6esmedJLCywAwnytALwNAAEJR4I7ANGrMk6BwtbVj7wg39usNlZphGbMXs-YAaQANPoh7Ogs4+07TfX-WOR3OfuKZ+PZmMFj6AEwABmv0AtVuxB6dHWgMn9kHLID62IGR4bJeLhuIeerfAufxLEcyjdAA1iAWgAObQKyvx7IcRyagYSG9noG7nm8O4DpAB4yM2qrtgA6qkcHThRraCp23Y7IU8wgdAABWBgAEbvAxbbMcETYtoJNHKHR+LFqEWj+gRgGzGWzhwXIAlMeJkmMgAHvSWiKO2aG7POsnyeBVgyPUOlhHpBmQSJlHQBpMrGf6iEoa4FgOO85GieptHTjB8FuahkE7AAMjhvYqox4BrsOZnWPGa4ecAXmqb51H+a6ABiiggFAckAFK8duACK6KQDswRKYOxh5QVXElUAA)

[Sequence диаграмма - Процесс отправки уведомления, отсечение по лимиту](https://sequencediagram.org/index.html#initialData=title%20%D0%9F%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%20%D0%BE%D1%82%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B8%20%D1%83%D0%B2%D0%B5%D0%B4%D0%BE%D0%BC%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F%20-%20%D0%BE%D1%82%D1%81%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BF%D0%BE%20%D0%BB%D0%B8%D0%BC%D0%B8%D1%82%D1%83%0A%0Aparticipant%20Notification%20request%0Aparticipant%20Notification%20Service%0Aparticipant%20Priority%20queue%0Aparticipant%20Rate%20limiter%0Aparticipant%20Event%20service%0A%0Aactivate%20Notification%20request%0ANotification%20request-%3ENotification%20Service%3APOST%5Cn%2Fapi%2Fv1%2Fnotifications%0ANotification%20Service-%3EPriority%20queue%3APrioritize%20notification%0APriority%20queue-%3ERate%20limiter%3AAuthorize%20request%0ARate%20limiter-%3EEvent%20service%3AGet%20channels%0AEvent%20service-%3ERate%20limiter%3A%5B%20%5D%20channels%0ARate%20limiter-%3ENotification%20Service%3ADecline%2C%20limit%20exceed%0ANotification%20Service-%3ENotification%20request%3A429%20Too%20Many%20Requests%0Aspace%20%0Adeactivate%20Notification%20request%0ANotification%20Service-%3ETracking%20service%3APOST%20log%3A%20limit%20exceed%0A)
